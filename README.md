# –ë–æ—Ç –≥–∞–∑–µ—Ç—ã ¬´–°–∏–±–∏—Ä—Å–∫–∞—è –æ–∫–æ–ª–∏—Ü–∞¬ª

–¢–µ–ª–µ–≥—Ä–∞–º-–±–æ—Ç –¥–ª—è –≥–∞–∑–µ—Ç—ã ¬´–°–∏–±–∏—Ä—Å–∫–∞—è –æ–∫–æ–ª–∏—Ü–∞¬ª (–¢–∞—Ç–∞—Ä—Å–∫). –ù–æ–≤–æ—Å—Ç–∏, –ø–æ–∏—Å–∫, –ø–æ–≥–æ–¥–∞, –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üì∞ –ü–æ—Å–ª–µ–¥–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç–∏ —Å sibokolica.ru
- üîç –ü–æ–∏—Å–∫ –ø–æ –Ω–æ–≤–æ–º—É –∏ —Å—Ç–∞—Ä–æ–º—É —Å–∞–π—Ç–∞–º (okolica.net)
- üìö –ê—Ä—Ö–∏–≤ –≤—ã–ø—É—Å–∫–æ–≤ –≥–∞–∑–µ—Ç—ã
- üå§Ô∏è –ü–æ–≥–æ–¥–∞ (Open-Meteo, –±–µ—Å–ø–ª–∞—Ç–Ω–æ)
- üìù –ü—Ä–µ–¥–ª–æ–∂–∏—Ç—å –Ω–æ–≤–æ—Å—Ç—å / –í –ì–æ–ª–æ—Å –Ω–∞—Ä–æ–¥–∞
- üì¢ –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–æ–≤—ã—Ö —Å—Ç–∞—Ç—å—è—Ö

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ (–ª–æ–∫–∞–ª—å–Ω–æ)

```bash
# –°–æ–∑–¥–∞—Ç—å .env
cp .env.example .env
# –ó–∞–ø–æ–ª–Ω–∏—Ç—å TELEGRAM_BOT_TOKEN, ADMIN_ID

# –ó–∞–ø—É—Å–∫
python bot.py
```

–†–µ–∂–∏–º **polling** ‚Äî –±–æ—Ç —Å–∞–º –æ–ø—Ä–∞—à–∏–≤–∞–µ—Ç Telegram.

## –î–µ–ø–ª–æ–π –Ω–∞ Vercel (webhook)

### 1. Push –Ω–∞ GitHub

```bash
git init
git add .
git commit -m "Initial commit"
git remote add origin https://github.com/Alexnikolaev1/okolica_botnewww.git
git branch -M main
git push -u origin main
```

### 2. –ü–æ–¥–∫–ª—é—á–∏—Ç—å –ø—Ä–æ–µ–∫—Ç –≤ Vercel

1. [vercel.com](https://vercel.com) ‚Üí Import Project ‚Üí –≤—ã–±—Ä–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
2. Environment Variables (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ):
   - `TELEGRAM_BOT_TOKEN` ‚Äî —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ –æ—Ç @BotFather
   - `ADMIN_ID` ‚Äî –≤–∞—à Telegram ID (–¥–ª—è –Ω–æ–≤–æ—Å—Ç–µ–π –∏ –æ–±—Ä–∞—â–µ–Ω–∏–π)
3. –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: `CRON_SECRET` ‚Äî —Å–µ–∫—Ä–µ—Ç –¥–ª—è –∑–∞—â–∏—Ç—ã cron endpoint
4. Deploy

### 3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å webhook

–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –ø–æ–ª—É—á–∏—Ç–µ URL –≤–∏–¥–∞ `https://okolicabotnewww.vercel.app`.

–í—ã–ø–æ–ª–Ω–∏—Ç–µ (–ø–æ–¥—Å—Ç–∞–≤—å—Ç–µ —Å–≤–æ–π —Ç–æ–∫–µ–Ω –∏ URL):

```bash
curl "https://api.telegram.org/bot<–í–ê–®_–¢–û–ö–ï–ù>/setWebhook?url=https://<–í–ê–®_–î–û–ú–ï–ù>/api/webhook"
```

–ò–ª–∏ –æ—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
```
https://api.telegram.org/bot<–¢–û–ö–ï–ù>/setWebhook?url=https://<–î–û–ú–ï–ù>/api/webhook
```

–ü—Ä–æ–≤–µ—Ä–∫–∞: `https://api.telegram.org/bot<–¢–û–ö–ï–ù>/getWebhookInfo`

### 4. Cron (–ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ–≤—ã—Ö —Å—Ç–∞—Ç–µ–π)

- **Vercel Hobby:** cron —Ä–∞–∑ –≤ –¥–µ–Ω—å (–≤ `vercel.json` ‚Äî 9:00 UTC)
- **Vercel Pro:** –º–æ–∂–Ω–æ —á–∞—â–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç)
- **–í–Ω–µ—à–Ω–∏–π cron:** [cron-job.org](https://cron-job.org) ‚Äî –≤—ã–∑—ã–≤–∞—Ç—å `GET https://<–¥–æ–º–µ–Ω>/api/cron` —Å –∑–∞–≥–æ–ª–æ–≤–∫–æ–º `Authorization: Bearer <CRON_SECRET>`

### 5. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

–ù–∞ Vercel `/tmp` ‚Äî –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è –∑–∞–ø–∏—Å—ã–≤–∞–µ–º–∞—è –ø–∞–ø–∫–∞. SQLite –≤ `/tmp` **–Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è** –º–µ–∂–¥—É cold start.

–î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:
- –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `DB_PATH=/tmp/okolica_bot.db` (–¥–∞–Ω–Ω—ã–µ —Ç–µ—Ä—è—é—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ)
- –∏–ª–∏ –ø–æ–¥–∫–ª—é—á–∏—Ç–µ –≤–Ω–µ—à–Ω—é—é –ë–î (Turso, Neon, Vercel Postgres)

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```
‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îú‚îÄ‚îÄ webhook.py   # Telegram webhook (Vercel)
‚îÇ   ‚îî‚îÄ‚îÄ cron.py     # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ–≤—ã—Ö —Å—Ç–∞—Ç–µ–π (Vercel Cron)
‚îú‚îÄ‚îÄ bot.py          # –û—Å–Ω–æ–≤–Ω–æ–π –±–æ—Ç
‚îú‚îÄ‚îÄ config.py       # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ database.py     # SQLite
‚îú‚îÄ‚îÄ parser.py       # –ü–∞—Ä—Å–∏–Ω–≥ sibokolica.ru, okolica.net
‚îú‚îÄ‚îÄ utils.py        # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
‚îú‚îÄ‚îÄ vercel.json     # –ö–æ–Ω—Ñ–∏–≥ Vercel
‚îî‚îÄ‚îÄ requirements.txt
```

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT
